<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ù…Ø·Ø¹Ù… Ø§Ù„Ù…Ø°Ø§Ù‚ Ø§Ù„Ø³ÙˆØ¯Ø§Ù†ÙŠØ© â€” Ø§Ù„Ù…ØªØ¬Ø± Ùˆ Ø§Ù„ÙÙˆØ§ØªÙŠØ±</title>
<style>
  /* ===== Ø¹Ø§Ù… ===== */
  :root{
    --primary:#c94a1f;
    --bg:#fffaf6;
    --card:#fff;
    --muted:#666;
    --shadow: 0 8px 24px rgba(0,0,0,0.08);
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:"Noto Naskh Arabic",Tahoma,Arial,system-ui;
    direction:rtl;
    background:var(--bg);
    color:#222;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
  }

  /* ===== ØªØ±ÙˆÙŠØ³Ø© ===== */
  header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:18px 20px;
    background:var(--card);
    border-bottom:1px solid #eee;
    position:sticky;
    top:0;
    z-index:20;
  }
  .brand{display:flex;align-items:center;gap:12px}
  .logo{
    width:56px;height:56px;border-radius:10px;background:var(--primary);
    display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:20px;
    box-shadow:0 6px 18px rgba(0,0,0,0.06);
  }
  header h1{margin:0;font-size:20px}
  .subtitle{color:var(--muted);font-size:13px}

  /* ===== Ø²Ø± Ø§Ù„Ø³Ù„Ø© ===== */
  .cart-btn{
    background:#fff;border:1px solid #eee;padding:8px 12px;border-radius:10px;display:flex;gap:8px;align-items:center;cursor:pointer;box-shadow:var(--shadow)
  }
  .cart-count{background:var(--primary);color:#fff;padding:4px 8px;border-radius:999px;font-weight:700}

  /* ===== Ø§Ù„ØµÙØ­Ø© ===== */
  main{max-width:1100px;margin:18px auto;padding:0 18px}
  p.lead{color:var(--muted);margin-top:8px}

  /* ===== ØªÙØ§ØµÙŠÙ„/Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø£ØµÙ†Ø§Ù ===== */
  details{background:var(--card);border-radius:10px;padding:8px;margin-bottom:14px;box-shadow:var(--shadow)}
  summary{display:flex;justify-content:space-between;align-items:center;cursor:pointer;padding:8px 12px;font-weight:700;font-size:16px}
  .items-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px;padding:10px}
  .item{background:#fff;border-radius:10px;padding:10px;display:flex;flex-direction:column;gap:8px;box-shadow:0 6px 18px rgba(0,0,0,0.03)}
  .item img{width:100%;height:150px;object-fit:cover;border-radius:8px}
  .item h4{margin:0;font-size:16px}
  .price{color:var(--primary);font-weight:800}
  .controls{display:flex;gap:8px;align-items:center;margin-top:auto}
  .qty{display:flex;align-items:center;gap:6px;border:1px solid #eee;padding:4px;border-radius:8px}
  .qty button{background:#f6f6f6;border:1px solid #eee;padding:4px 8px;border-radius:6px;cursor:pointer}
  .btn-add{background:var(--primary);color:#fff;border:0;padding:8px 10px;border-radius:8px;cursor:pointer;font-weight:700}

  /* ===== footer ===== */
  footer{max-width:1100px;margin:30px auto 60px;padding:18px;text-align:center;color:var(--muted)}
  .bank{display:flex;gap:12px;align-items:center;justify-content:center;margin-top:10px;flex-wrap:wrap}
  .bank img{width:96px;height:auto}

  /* ===== Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ø³Ù„Ø© ===== */
  .overlay{position:fixed;inset:0;background:rgba(0,0,0,0.45);display:none;align-items:center;justify-content:center;padding:20px;z-index:999}
  .overlay.open{display:flex}
  .modal{background:#fff;width:100%;max-width:760px;border-radius:12px;padding:16px;max-height:90vh;overflow:auto}
  .cart-list{display:flex;flex-direction:column;gap:10px;margin-top:8px}
  .cart-row{display:flex;gap:10px;align-items:center;border-radius:8px;padding:8px;background:#fafafa}
  .cart-row img{width:84px;height:64px;object-fit:cover;border-radius:6px}
  .cart-meta{flex:1}
  .cart-actions{display:flex;gap:8px;align-items:center}
  .checkout{margin-top:12px;border-top:1px solid #eee;padding-top:12px}
  .hidden{display:none}
  .invoice-preview{background:#fff;padding:10px;border-radius:8px;border:1px dashed #eee;margin-top:8px}

  /* responsive */
  @media (max-width:640px){
    .items-grid{grid-template-columns:repeat(1,1fr)}
    header{flex-direction:column;align-items:stretch;gap:8px}
  }

  /* =====-toast simple style===== */
  #__toast{transition:opacity .25s ease-in-out}
</style>
</head>
<body>

<!-- ========== HEADER ========== -->
<header>
  <div class="brand">
    <div class="logo">Ù…</div>
    <div>
      <h1>Ù…Ø·Ø¹Ù… Ø§Ù„Ù…Ø°Ø§Ù‚ Ø§Ù„Ø³ÙˆØ¯Ø§Ù†ÙŠØ©</h1>
      <div class="subtitle">Ù†ÙƒÙ‡Ø§Øª Ø³ÙˆØ¯Ø§Ù†ÙŠØ© Ø£ØµÙŠÙ„Ø© â€” Ø§Ù„Ø®Ø±Ø·ÙˆÙ…ØŒ Ø§Ù„ÙƒÙ„Ø§ÙƒÙ„Ø©</div>
    </div>
  </div>

  <div style="display:flex;gap:12px;align-items:center">
    <div style="text-align:left;color:var(--muted);font-size:13px">
      ğŸ“ +249 117442625<br>âœ‰ï¸ wlydmyrghny51@gmail.com
    </div>
    <button id="openCart" class="cart-btn" aria-label="ÙØªØ­ Ø§Ù„Ø³Ù„Ø©">
      <span>Ø§Ù„Ø³Ù„Ø©</span>
      <span id="cartCount" class="cart-count">0</span>
    </button>
  </div>
</header>

<!-- ========== MAIN ========== -->
<main>
  <p class="lead">Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø£Ø¯Ù†Ø§Ù‡. Ù„ÙƒÙ„ ØµÙ†Ù ØµÙˆØ±Ø© ÙˆØ³Ø¹Ø± (Ø¬.Ø³) ÙˆØ§Ù„ÙƒÙ…ÙŠØ© â€” Ø£Ø¶Ù Ù…Ø§ ØªØ±ÙŠØ¯ Ø«Ù… Ø§Ø¶ØºØ· Ø¹Ø±Ø¶ Ø§Ù„Ø³Ù„Ø© Ù„Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨.</p>

  <section>
    <div id="categories"></div>
  </section>
</main>

<!-- ========== CART / CHECKOUT MODAL ========== -->
<div id="overlay" class="overlay" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true">
    <button id="closeOverlay" style="float:left;border:0;background:none;font-size:18px;cursor:pointer">âœ• Ø¥ØºÙ„Ø§Ù‚</button>
    <h2>Ø³Ù„Ø© Ø§Ù„Ø·Ù„Ø¨</h2>

    <div id="cartList" class="cart-list"></div>

    <div style="margin-top:12px;display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap">
      <div style="font-weight:800">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ù†Ø§ØµØ±: <span id="cartItems">0</span></div>
      <div style="font-weight:900;font-size:18px">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: <span id="cartTotal">0</span> Ø¬.Ø³</div>
    </div>

    <div class="checkout">
      <h3>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø²Ø¨ÙˆÙ† Ùˆ Ø§Ù„Ø¯ÙØ¹ (Ø¥Ø¬Ø¨Ø§Ø±ÙŠ Ø±ÙØ¹ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¯ÙØ¹)</h3>
      <form id="checkoutForm">
        <div style="display:flex;gap:8px;flex-wrap:wrap">
          <input id="cName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" required style="flex:1;padding:8px;border-radius:6px;border:1px solid #eee">
          <input id="cPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„" required style="flex:1;padding:8px;border-radius:6px;border:1px solid #eee">
        </div>

        <textarea id="cAddress" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†/ØªØ¹Ù„ÙŠÙ…Ø§Øª (Ù…Ø«Ù„Ø§Ù‹: Ø§Ù„Ø®Ø±Ø·ÙˆÙ… - Ø§Ù„ÙƒÙ„Ø§ÙƒÙ„Ø©)" style="width:100%;margin-top:8px;padding:8px;border-radius:6px;border:1px solid #eee"></textarea>

        <!-- ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¥ÙŠØµØ§Ù„ Ù…Ù† Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø­Ø³Ù‘Ù†: Ø§Ù„Ø¢Ù† Ø¥Ø¬Ø¨Ø§Ø±ÙŠ -->
        <div style="margin-top:8px">
          <label for="receiptFile" style="font-size:13px;color:var(--muted);font-weight:700">ØªØ­Ù…ÙŠÙ„ Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø¯ÙØ¹ (ØµÙˆØ±Ø©) â€” <span style="color:#c94a1f">Ø¥Ø¬Ø¨Ø§Ø±ÙŠ</span></label><br>
          <input id="receiptFile" type="file" accept="image/*" style="margin-top:6px" required>
          <div id="receiptPreview" style="margin-top:8px"></div>
        </div>

        <div id="paymentInfo" style="margin-top:12px;background:#fafafa;padding:10px;border-radius:8px">
          <strong>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹:</strong>
          <select id="checkoutPaymentMethod" required style="width:100%;margin-top:8px;padding:8px;border-radius:6px;border:1px solid #eee">
            <option value="">-- Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹ --</option>
            <option value="ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ">ğŸ¦ ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ</option>
            <option value="Ù…Ø­ÙØ¸Ø© Ø§Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©">ğŸ“± Ù…Ø­ÙØ¸Ø© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</option>
            <option value="Ù†Ù‚Ø¯Ø§Ù‹ Ø¹Ù†Ø¯ Ø§Ù„ØªØ³Ù„ÙŠÙ…">ğŸ’µ Ù†Ù‚Ø¯Ø§Ù‹ Ø¹Ù†Ø¯ Ø§Ù„ØªØ³Ù„ÙŠÙ…</option>
          </select>

          <div style="color:var(--muted);margin-top:8px;font-size:13px">
            Ù…Ù„Ø§Ø­Ø¸Ø©: Ø¨Ø¹Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ "Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨" Ø³ØªÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©. Ø¨Ø¹Ø¯ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© Ø§Ø¶ØºØ· "ÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨" Ø£Ùˆ Ø§Ù†ØªØ¸Ø± Ø§Ù„Ø¶ØºØ· Ø¹Ù„ÙŠÙ‡ Ù„ÙŠØªÙ… ÙØªØ­ Ù…Ø­Ø§Ø¯Ø«Ø© ÙˆØ§ØªØ³Ø§Ø¨ Ø¨ØµÙŠØºØ© Ø¬Ø§Ù‡Ø²Ø© â€” Ø«Ù… Ù‚Ù… Ø¨Ø¥Ø±ÙØ§Ù‚ ØµÙˆØ±Ø© Ø§Ù„Ø¥ÙŠØµØ§Ù„ (Ø§Ù„ØªÙŠ Ù‚Ù…Øª Ø¨ØªØ­Ù…ÙŠÙ„Ù‡Ø§) ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙØ§ØªÙˆØ±Ø© ÙŠØ¯ÙˆÙŠØ§Ù‹ ÙÙŠ ÙˆØ§ØªØ³Ø§Ø¨.
          </div>
        </div>

        <div style="display:flex;gap:8px;margin-top:10px">
          <button type="submit" class="btn-add" style="flex:1">Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
          <button type="button" id="clearCart" style="flex:1;background:#eee;border:0;border-radius:8px">ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø©</button>
        </div>
      </form>

      <div id="invoicePreview" class="invoice-preview hidden"></div>
    </div>

  </div>
</div>

<!-- ========== FOOTER ========== -->
<footer>
  <div style="max-width:1100px;margin:0 auto">
    <div style="font-weight:800;margin-bottom:6px">Ù†Ø¨Ø°Ø© Ø¹Ù† Ø§Ù„Ù…Ø·Ø¹Ù…</div>
    <div style="color:var(--muted);margin-bottom:12px">
      Ù…Ø·Ø¹Ù… Ø§Ù„Ù…Ø°Ø§Ù‚ Ø§Ù„Ø³ÙˆØ¯Ø§Ù†ÙŠØ© ÙŠÙ‚Ø¯Ù… Ø£Ø·Ø¨Ø§Ù‚Ø§Ù‹ Ø³ÙˆØ¯Ø§Ù†ÙŠØ© Ø£ØµÙŠÙ„Ø© ÙˆÙ…Ø´ÙˆÙŠØ§Øª ÙˆÙØ·Ø§Ø¦Ø± ÙˆØ¹ØµØ§Ø¦Ø± Ø·Ø§Ø²Ø¬Ø©. Ù†Ø³ØªØ®Ø¯Ù… Ù…ÙƒÙˆÙ†Ø§Øª Ø·Ø§Ø²Ø¬Ø© ÙˆÙ†Ù„ØªØ²Ù… Ø¨Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù†Ø¸Ø§ÙØ© ÙˆØ¬ÙˆØ¯Ø© Ø§Ù„ØªØ­Ø¶ÙŠØ±.
    </div>

    <div style="font-weight:800">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„</div>
    <div style="color:var(--muted);margin-top:6px">
      Ø§Ù„Ù‡Ø§ØªÙ: +249 117442625 &nbsp; | &nbsp; Ø§Ù„Ø¨Ø±ÙŠØ¯: wlydmyrghny51@gmail.com &nbsp; | &nbsp; Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: Ø§Ù„Ø®Ø±Ø·ÙˆÙ… - Ø§Ù„ÙƒÙ„Ø§ÙƒÙ„Ø©
    </div>

    <div class="bank" style="margin-top:14px">
     <img src="https://play-lh.googleusercontent.com/6ycub52gYLRnYtuE0t-1UC4KsHGaXR84ol0RoezDg7U_ZFkSmSrtig9170O1TXZJQg" alt="ØµÙˆØ±Ø© Ù…Ù† Googleusercontent" style="width:100px; height:auto; border:1px solid #ccc; border-radius:8px;"> 
      <div style="text-align:right">
        <div style="font-weight:800">Ø§Ù„Ø¯ÙØ¹ Ø¹Ø¨Ø± Ø¨Ù†ÙƒÙƒ</div>
        <div style="color:var(--muted)">Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨: <strong>9330039</strong></div>
      </div>
    </div>

    <div style="color:var(--muted);margin-top:12px">Â© 2025 Ù…Ø·Ø¹Ù… Ø§Ù„Ù…Ø°Ø§Ù‚ Ø§Ù„Ø³ÙˆØ¯Ø§Ù†ÙŠØ©</div>
  </div>
</footer>

<!-- ========== SCRIPT Ø´Ø§Ù…Ù„ ÙˆÙ…ÙˆØ­Ø¯ Ù„Ù„Ù…Ø´Ø±ÙˆØ¹ ========== -->
<script>
/* ============================================================
   Ø§Ù„ÙƒÙˆØ¯ Ø£Ø¯Ù†Ø§Ù‡ ÙŠØ¬Ù…Ø¹:
   - Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© Ù…Ù† "catalog"
   - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø³Ù„Ø© (add/remove/change)
   - Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ù…Ø±ÙÙˆØ¹ (Ù…Ø·Ù„ÙˆØ¨)
   - Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø§ÙØ°Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„ØªÙŠ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ + ØµÙˆØ±Ø© Ø§Ù„Ø¥ÙŠØµØ§Ù„
   - Ø²Ø± Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© ÙÙŠ Ù†Ø§ÙØ°Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø© ÙŠÙ‚ÙˆÙ… Ø¨Ø§Ù„Ù€ print() Ø«Ù… ÙŠÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨ Ø¨Ø±Ø³Ø§Ù„Ø© Ø¬Ø§Ù‡Ø²Ø©
   - Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø³Ù„Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
   ============================================================ */

/* ======== Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© Ø¨Ø³ÙŠØ·Ø© ======== */
function escapeHtml(str){
  if(!str) return '';
  return String(str)
    .replace(/&/g, '&amp;')
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;')
    .replace(/"/g, '&quot;')
    .replace(/'/g, '&#39;');
}

function showToast(msg){
  let t = document.getElementById('__toast');
  if(!t){
    t = document.createElement('div'); t.id='__toast';
    t.style.position='fixed'; t.style.bottom='18px'; t.style.left='50%'; t.style.transform='translateX(-50%)';
    t.style.background='rgba(0,0,0,0.8)'; t.style.color='#fff'; t.style.padding='10px 14px';
    t.style.borderRadius='10px'; t.style.zIndex=9999; t.style.opacity='0';
    document.body.appendChild(t);
  }
  t.textContent = msg;
  t.style.opacity = '1';
  clearTimeout(window.__toastTimer);
  window.__toastTimer = setTimeout(()=>{ t.style.opacity='0'; }, 2200);
}

/* ====== Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ØµÙ†Ø§Ù (catalog) ====== */
/* (Ø§Ø³ØªØ®Ø¯Ù…Øª Ù†ÙØ³ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙŠ Ø²ÙˆØ¯ØªÙ†ÙŠ Ø¨Ù‡Ø§ â€” ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„ Ø£Ùˆ Ø¥Ø¶Ø§ÙØ© Ø£ØµÙ†Ø§Ù Ù‡Ù†Ø§) */
const catalog = [
  {
    id: 'grill',
    title: 'Ù‚Ø³Ù… Ø§Ù„Ù…Ø´ÙˆÙŠØ§Øª',
    items: [{id:'grill1', name:'ÙƒØ¨Ø§Ø¨ Ù„Ø­Ù…', price:5500, img:'https://i.ytimg.com/vi/2L5jeZb9g4c/maxresdefault.jpg'},
     {id:'grill2', name:'ÙƒØ¨Ø§Ø¨ Ø¯Ø¬Ø§Ø¬', price:5000, img:'https://zfloos-production-storage.s3.eu-central-1.amazonaws.com/public/upload/companies/2366/products/1655313988_62aa1644d6325.jpg'},
      {id:'grill3', name:'Ø±ÙŠØ´ ØºÙ†Ù…', price:5000, img:'https://images.unsplash.com/photo-1544025162-d76694265947?w=800&q=60&auto=format&fit=crop'},
      {id:'grill3b', name:'Ø³Ø¬Ù‚ Ù„Ø­Ù…', price:4800, img:'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ-gD5K0r81S8DSwU26Zo8dn0hwfz10qFMYzyS89r_KPxVv83RuVLid1DIM&s=10'},
      {id:'grill4', name:'Ø¯Ø¬Ø§Ø¬ Ù…Ø´ÙˆÙŠ', price:6000, img:'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRYgyxFwPzRX_oIHrO2sgv0Lw9JnWwIDJtT2nzvHxFcuCxKA0_jMYK1-I4&s=10'},
      {id:'grill6', name:'Ø¨Ø±ØºØ± Ù…Ø´ÙˆÙŠ', price:2800, img:'https://images.unsplash.com/photo-1550547660-d9450f859349?w=800&q=60&auto=format&fit=crop'},
      {id:'grill5', name:'ÙƒÙØªØ© Ù…Ø´ÙˆÙŠØ©', price:5200, img:'https://v-genius.fatafeat.com/storage/attachments/21/Fatafeat-26Nov-article2_611791.png/r/800/Fatafeat-26Nov-article2_611791.png'},
      {id:'grill6b', name:'Ø´ÙŠØ´ Ø·Ø§ÙˆÙ‚', price:5600, img:'https://static.webteb.net/images/content/ramadanrecipe_recipe_141_360.jpg'},
      {id:'grill7', name:'Ø¶Ù„Ø¹ Ù„Ø­Ù…', price:7000, img:'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQUdYigwB9Ec7ifWJltl6v-dpqh86He-qklMkSprC5ovw&s=10'},
      {id:'grill8', name:'Ø³Ù„Ù…ÙˆÙ† Ù…Ø´ÙˆÙŠ', price:7500, img:'https://png.pngtree.com/png-clipart/20250206/original/pngtree-grilled-salmon-fillet-with-fresh-vegetables-on-white-plate-png-image_20344973.png'},
    ]
  },
  {
    id: 'pies',
    title: 'Ù‚Ø³Ù… Ø§Ù„ÙØ·Ø§Ø¦Ø±',
    items: [
      {id:'pie1', name:'ÙØ·ÙŠØ±Ø© Ø¬Ø¨Ù†Ø©', price:3500, img:'https://images.arla.com/recordid/21444B24-CACB-481C-AC18C536BE6C93B7/puffy-cheese-and-olive-pastry.jpg?width=768&height=400&mode=crop&format=webp'},
      {id:'pie2', name:'ÙØ·ÙŠØ±Ø© Ù„Ø­Ù…', price:3700, img:'https://cdn.arabsstock.com/uploads/images/218956/pieces-of-hot-meat-pie-thumbnail-218956.webp'},
      {id:'pie3', name:'ÙØ·ÙŠØ±Ø© Ø³Ø¨Ø§Ù†Ø®', price:3600, img:'https://cdn.al-ain.com/lg/images/2018/4/24/47-140459-177-203614-15a9ec37e9fd1d_700x400.jpeg'},
      {id:'pie4', name:'ÙØ·ÙŠØ±Ø© Ø¯Ø¬Ø§Ø¬', price:3800, img:'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQMistnuPkmCFrb6YEZcIEThax6M6rtPdiC02v4NTY9YA&s=10'},
      {id:'pie5', name:'ÙØ·ÙŠØ±Ø© Ø¨ÙŠØªØ²Ø§', price:4000, img:'https://cdn.arabsstock.com/uploads/images/36511/fresh-delicious-pizza-pie-vegetable-preview-36511.jpg'},
      {id:'pie6', name:'ÙØ·ÙŠØ±Ø© Ù„Ø¨Ù†Ø©', price:3400, img:'https://i.ytimg.com/vi/CyQRSYjf06U/sddefault.jpg'},
      {id:'pie7', name:'ÙØ·ÙŠØ±Ø© Ø¹Ø³Ù„', price:3200, img:'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQSGL8TAooFZbEH1Ah8G_QKSuz8M095JtVCxN7gNh6s9yLyaQXT7ErayB8&s=10'},
      {id:'pie8', name:'ÙØ·ÙŠØ±Ø© Ø´ÙˆÙƒÙˆÙ„Ø§ØªØ©', price:4200, img:'https://img.youm7.com/ArticleImgs/2019/7/10/240776-8.jpg'},
      {id:'pie9', name:'ÙØ·ÙŠØ±Ø© Ø®Ø¶Ø§Ø±', price:3700, img:'https://i.ytimg.com/vi/4SNxUWmdGdg/sddefault.jpg'},
      {id:'pie10', name:'ÙØ·ÙŠØ±Ø© ØªÙˆÙ†Ø©', price:3900, img:'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTwcEbwY_w-VWkTIp32vfBomrNrtyd0HkxMkBX7q4egT1uqEqtZQn5onaH-&s=10'},
    ]
  },
  {
    id: 'juices',
    title: 'Ù‚Ø³Ù… Ø§Ù„Ø¹ØµØ§Ø¦Ø±',
    items: [
      {id:'juice1', name:'Ø¹ØµÙŠØ± Ø¨Ø±ØªÙ‚Ø§Ù„', price:2500, img:'https://bmzag.com/cdn/shop/files/2021_7_6_2_9_50_937.jpg?v=1707299214'},
      {id:'juice2', name:'Ø¹ØµÙŠØ± Ù…Ø§Ù†Ø¬Ùˆ', price:2700, img:'https://media-cdn.tripadvisor.com/media/photo-p/1b/6e/b9/58/mango-juice.jpg'},
      {id:'juice3', name:'Ø¹ØµÙŠØ± Ø¬ÙˆØ§ÙØ©', price:2600, img:'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRHsbDql-m6Yl_iyZEYkqTGmO8JF6A7msUHj07V0t50zBH8eEJEF83jtQqI&s=10'},
      {id:'juice4', name:'Ø¹ØµÙŠØ± Ù„ÙŠÙ…ÙˆÙ†', price:2400, img:'https://www.justfood.tv/big/4mJFR333.1.2020.jpg'},
      {id:'juice5', name:'Ø¹ØµÙŠØ± ØªÙØ§Ø­', price:2600, img:'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSNTQbm9SyQgeTClbuLbUqip7FVQ-ztiPI-GD5lZXeX6tNvmlwJkXMd3yc&s=10'},
      {id:'juice6', name:'Ø¹ØµÙŠØ± ÙƒÙŠÙˆÙŠ ', price:2800, img:'https://modo3.com/thumbs/fit630x300/246034/1562257915/%D8%B7%D8%B1%D9%8A%D9%82%D8%A9_%D8%B9%D9%85%D9%84_%D8%B9%D8%B5%D9%8A%D8%B1_%D9%83%D9%8A%D9%88%D9%8A_%D8%A8%D8%A7%D9%84%D8%AD%D9%84%D9%8A%D8%A8.jpg'},
      {id:'juice7', name:'Ø¹ØµÙŠØ± ÙØ±Ø§ÙˆÙ„Ø© ', price:2900, img:'https://png.pngtree.com/thumb_back/fw800/background/20240419/pngtree-smoothie-with-strawberries-and-milk-image_15663375.jpg'},
      {id:'juice8', name:'Ø¹ØµÙŠØ± Ø¨Ø·ÙŠØ®', price:2500, img:'https://static.hiamag.com/2022-08/%D8%B7%D8%B1%D9%8A%D9%82%D8%A9%20%D8%B9%D9%85%D9%84%20%D8%B9%D8%B5%D9%8A%D8%B1%20%D8%A7%D9%84%D8%A8%D8%B7%D9%8A%D8%AE%20%D8%A8%D8%A7%D9%84%D8%A3%D9%84%D9%88%D9%81%D9%8A%D8%B1%D8%A7.jpg'},
      {id:'juice9', name:'Ø¹ØµÙŠØ± Ø£Ù†Ø§Ù†Ø§Ø³', price:2700, img:'https://cdn.arabsstock.com/uploads/images/306152/delicious-cold-natural-drinks-saudi-thumbnail-306152.webp'},
      {id:'juice10', name:'Ø¹ØµÙŠØ± Ù…ÙˆØ² Ø¨Ø§Ù„Ø­Ù„ÙŠØ¨', price:2800, img:'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRxyY-XwJ562gAuo9d-OO1EqKdBQixWcOgjU4kf-d8vGgokf-MHRyRMxfQ&s=10'},
    ]
  },
  {
    id: 'sudan',
    title: 'Ù‚Ø³Ù… Ø§Ù„Ù…Ø£ÙƒÙˆÙ„Ø§Øª Ø§Ù„Ø´Ø¹Ø¨ÙŠØ© Ø§Ù„Ø³ÙˆØ¯Ø§Ù†ÙŠØ©',
    items: [
      {id:'sudan1', name:'ÙƒØ³Ø±Ø© Ùˆ Ù…Ù„Ø§Ø­', price:4500, img:'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRxg_Yd5MQcmiFNgDYWMpriFMxt-ERpmy_k_v-m_0ccOpvvW5O8IFXU5J0&s=10'},
      {id:'sudan2', name:'Ø¹ØµÙŠØ¯Ø© Ø¨Ù…Ù„Ø§Ø­ ÙˆÙŠÙƒØ©', price:4700, img:'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTkkSKAEA068M0f2Nxv4LnOwWYOARHazM7yVQ1IyQQpydhTgLJVqtG5mkHC&s=10'},
      {id:'sudan3', name:'ÙØªØ© Ø³ÙˆØ¯Ø§Ù†ÙŠØ©', price:4800, img:'https://sudafax.com/wp-content/uploads/2022/02/%D9%81%D8%AA%D8%A9-%D9%81%D9%88%D9%84-_-%D8%A8%D9%88%D8%B4-_-%D9%81%D8%AA%D9%87-390x220.jpg'},
      {id:'sudan4', name:'Ù‚Ø±Ø§ØµØ© Ø¨Ø§Ù„Ø¯Ù…Ø¹Ø©', price:4600, img:'https://pbs.twimg.com/media/ET26IEzWoAIA_op.png'},
      {id:'sudan5', name:'Ù‚Ø±Ø§ØµØ© Ø¨Ø§Ù„Ø²Ø¨Ø§Ø¯ÙŠ', price:4700, img:'https://i.ytimg.com/vi/a_skmdt42SY/sddefault.jpg'},
      {id:'sudan6', name:'Ù‚Ø±Ø§ØµØ© Ø¨Ø§Ù„Ù…Ù„ÙˆØ­Ø©', price:4900, img:'https://i.ytimg.com/vi/wOMGPHYQtOo/hq720.jpg?sqp=-oaymwEhCK4FEIIDSFryq4qpAxMIARUAAAAAGAElAADIQj0AgKJD&rs=AOn4CLBcFaMn1RoJG10qO-hfvy7En39zTA'},
      {id:'sudan7', name:'Ù…Ù„Ø§Ø­ Ø±ÙˆØ¨', price:4500, img:'https://arabicook.com/wp-content/uploads/2023/04/or-13.jpeg'},
      {id:'sudan9', name:'ÙƒØ³Ø±Ø© Ø¨Ø§Ù„Ø·Ù…Ø§Ø·Ù…', price:4400, img:'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR0TXGlGQDMnATLyUyOlzuvvXickQkcwE15OYnuJua-b7uYK04f0KgbQt0&s=10'},
      {id:'sudan10', name:'ÙˆØ¬Ø¨Ø© Ø¹Ø¯Ø³', price:4300, img:'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS3wORSI7I0_LPaZnFQTDLxVaMsQgO05YxW-tAKgJ5yLIBLGDJstI7l1w&s=10'},
      {id:'sudan8', name:'Ù…Ù„Ø§Ø­ Ø¨Ø§Ù…ÙŠØ©', price:4600, img:'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTPyT56P-Hnl_UQk7qbFN8llbFuYZ1exmWsrDa_8YHtwMLjz4r3hTruhWFn&s=10'},
    ]
  }
];

/* ===== Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ù„Ø© ===== */
let cart = {}; // key = itemId -> {id,name,price,img,qty}

/* ===== Ø¹Ù†Ø§ØµØ± DOM Ø§Ù„Ù…Ù‡Ù…Ø© ===== */
const categoriesEl = document.getElementById('categories');
const cartCountEl = document.getElementById('cartCount');
const cartListEl = document.getElementById('cartList');
const cartTotalEl = document.getElementById('cartTotal');
const cartItemsEl = document.getElementById('cartItems');
const paymentInfoEl = document.getElementById('paymentInfo');
const invoicePreviewEl = document.getElementById('invoicePreview');
const receiptFileInput = document.getElementById('receiptFile');
const receiptPreviewDiv = document.getElementById('receiptPreview');

/* ===== Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© Ù…Ù† Ø§Ù„ÙƒØ§ØªØ§Ù„ÙˆØ¬ ===== */
catalog.forEach(cat => {
  const d = document.createElement('details');
  d.innerHTML = `
    <summary>
      <span>${cat.title}</span>
      <span style="color:var(--muted);font-weight:600">${cat.items.length} ØµÙ†Ù</span>
    </summary>
    <div class="items-grid"></div>
  `;
  const grid = d.querySelector('.items-grid');

  cat.items.forEach(it => {
    const itEl = document.createElement('div');
    itEl.className = 'item';
    itEl.innerHTML = `
      <img src="${it.img}" alt="${escapeHtml(it.name)}" onerror="this.onerror=null;this.src='https://via.placeholder.com/800x600?text=ØµÙˆØ±Ø©'">
      <h4>${escapeHtml(it.name)}</h4>
      <div class="price">${it.price} Ø¬.Ø³</div>
      <div class="controls">
        <div class="qty" aria-label="ÙƒÙ…ÙŠØ©">
          <button data-op="dec">âˆ’</button>
          <div style="min-width:28px;text-align:center" data-qty>1</div>
          <button data-op="inc">+</button>
        </div>
        <button class="btn-add" data-add>Ø£Ø¶Ù</button>
      </div>
    `;
    const qtyEl = itEl.querySelector('[data-qty]');
    itEl.querySelector('[data-op="inc"]').addEventListener('click', ()=> {
      qtyEl.textContent = Number(qtyEl.textContent) + 1;
    });
    itEl.querySelector('[data-op="dec"]').addEventListener('click', ()=> {
      const n = Number(qtyEl.textContent);
      if(n>1) qtyEl.textContent = n-1;
    });
    itEl.querySelector('[data-add]').addEventListener('click', ()=> {
      const qty = Number(qtyEl.textContent);
      addToCart({id: it.id, name: it.name, price: it.price, img: it.img}, qty);
      qtyEl.textContent = 1;
    });

    grid.appendChild(itEl);
  });

  categoriesEl.appendChild(d);
});

/* ===== Ø¯ÙˆØ§Ù„ Ø§Ù„Ø³Ù„Ø© ===== */
function addToCart(product, qty=1){
  if(!cart[product.id]) cart[product.id] = {...product, qty:0};
  cart[product.id].qty += qty;
  updateCartUI();
  showToast(`${product.name} Ø£Ø¶ÙŠÙ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø© (${qty})`);
}

function updateCartUI(){
  const totalQty = Object.values(cart).reduce((s,i)=>s+i.qty,0);
  cartCountEl.textContent = totalQty;

  cartListEl.innerHTML = '';
  let sum = 0;
  for(const key in cart){
    const it = cart[key];
    sum += it.price * it.qty;
    const row = document.createElement('div');
    row.className = 'cart-row';
    row.innerHTML = `
      <img src="${it.img}" alt="${escapeHtml(it.name)}" onerror="this.onerror=null;this.src='https://via.placeholder.com/200x150?text=ØµÙˆØ±Ø©'">
      <div class="cart-meta">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <strong>${escapeHtml(it.name)}</strong>
          <span style="font-weight:800">${it.price} Ø¬.Ø³</span>
        </div>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px">
          <div class="cart-actions">
            <button data-op="dec">âˆ’</button>
            <div style="padding:6px 10px;border-radius:6px;border:1px solid #eee">${it.qty}</div>
            <button data-op="inc">+</button>
          </div>
          <button data-remove style="background:transparent;border:0;color:#d00;cursor:pointer">Ø­Ø°Ù</button>
        </div>
      </div>
    `;
    row.querySelector('[data-op="inc"]').addEventListener('click', ()=> { changeQty(it.id, +1); });
    row.querySelector('[data-op="dec"]').addEventListener('click', ()=> { changeQty(it.id, -1); });
    row.querySelector('[data-remove]').addEventListener('click', ()=> { removeItem(it.id); });

    cartListEl.appendChild(row);
  }

  cartTotalEl.textContent = sum.toLocaleString('en-US');
  cartItemsEl.textContent = totalQty;

  if(totalQty>0) {
    invoicePreviewEl.classList.remove('hidden');
    invoicePreviewEl.innerHTML = generateInvoiceHtmlPreview();
  } else {
    invoicePreviewEl.classList.add('hidden');
    invoicePreviewEl.innerHTML = '';
  }
}

function changeQty(id, delta){
  if(!cart[id]) return;
  cart[id].qty += delta;
  if(cart[id].qty <= 0) delete cart[id];
  updateCartUI();
}
function removeItem(id){
  delete cart[id];
  updateCartUI();
}

/* ===== ÙØªØ­/Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ ===== */
const overlay = document.getElementById('overlay');
document.getElementById('openCart').addEventListener('click', ()=> {
  overlay.classList.add('open');
  overlay.setAttribute('aria-hidden','false');
  updateCartUI();
});
document.getElementById('closeOverlay').addEventListener('click', ()=> {
  overlay.classList.remove('open');
  overlay.setAttribute('aria-hidden','true');
});
document.getElementById('clearCart').addEventListener('click', ()=> {
  if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø©ØŸ')){ cart = {}; updateCartUI(); }
});

/* ===== Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¥ÙŠØµØ§Ù„ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„ (Ù…Ø·Ù„ÙˆØ¨) ===== */
let currentReceiptDataUrl = null;
receiptFileInput.addEventListener('change', (ev)=>{
  const f = ev.target.files[0];
  receiptPreviewDiv.innerHTML = '';
  currentReceiptDataUrl = null;
  if(f && f.type.startsWith('image/')){
    const img = document.createElement('img');
    img.style.maxWidth = '160px';
    img.style.borderRadius = '8px';
    img.style.border = '1px solid #eee';
    img.style.display = 'block';
    img.style.marginTop = '6px';
    const reader = new FileReader();
    reader.onload = ()=>{
      img.src = reader.result;
      receiptPreviewDiv.appendChild(img);
      currentReceiptDataUrl = reader.result; // Ø­ÙØ¸ DataURL Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ ÙÙŠ Ù†Ø§ÙØ°Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø©
    };
    reader.readAsDataURL(f);
  } else {
    // Ø¥Ù† Ù„Ù… ÙŠÙƒÙ† Ù…Ù„Ù ØµÙˆØ±Ø© Ø£Ùˆ Ù„Ù… ÙŠÙØ®ØªÙØ±
    receiptPreviewDiv.innerHTML = '<div style="color:#c94a1f;font-size:13px">Ø§Ù„Ù…Ù„Ù ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ… - Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø©.</div>';
  }
});

/* ===== Ù…Ø¹Ø§ÙŠÙ†Ø© ÙØ§ØªÙˆØ±Ø© ØµØºÙŠØ±Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ ===== */
function generateInvoiceHtmlPreview(){
  const items = Object.values(cart);
  if(items.length === 0) return '';
  const rows = items.map(i => `<div style="display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px solid #f0f0f0"><div>${escapeHtml(i.name)} Ã— ${i.qty}</div><div>${i.price * i.qty} Ø¬.Ø³</div></div>`).join('');
  const total = items.reduce((s,i)=>s + i.price*i.qty,0);
  return `<div style="font-weight:800;margin-bottom:6px">ÙØ§ØªÙˆØ±Ø© Ø³Ø±ÙŠØ¹Ø©</div>${rows}<div style="text-align:left;font-weight:900;margin-top:8px">${total} Ø¬.Ø³</div>`;
}

/* ===== Ø­Ø¯Ø« Ø¥Ø±Ø³Ø§Ù„ Ù…ÙˆØ­Ø¯: Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø© Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© + ÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨ Ø¨Ø¹Ø¯ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© ===== */
document.getElementById('checkoutForm').addEventListener('submit', (e)=>{
  e.preventDefault();

  if(Object.keys(cart).length === 0){ alert('Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©'); return; }

  const name = document.getElementById('cName').value.trim();
  const phone = document.getElementById('cPhone').value.trim();
  const address = document.getElementById('cAddress').value.trim() || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
  const paymentMethod = document.getElementById('checkoutPaymentMethod').value.trim();
  const receiptFile = document.getElementById('receiptFile').files[0];

  if(!name || !phone){
    alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„');
    return;
  }
  if(!paymentMethod){
    alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹');
    return;
  }
  // ØªØ­Ù‚Ù‚ Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø±ÙØ¹ Ø¥ÙŠØµØ§Ù„ (Ø¥Ø¬Ø¨Ø§Ø±ÙŠ)
  if(!receiptFile){
    alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø±ÙØ¹ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¯ÙØ¹ (ØµÙˆØ±Ø©) Ù‚Ø¨Ù„ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©.');
    return;
  }
  if(!currentReceiptDataUrl){
    alert('Ø¬Ø§Ø±Ù ØªØ¬Ù‡ÙŠØ² Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¥ÙŠØµØ§Ù„ â€” Ø§Ù†ØªØ¸Ø± Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ø«Ù… Ø­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ø§Ù‹.');
    return;
  }

  // Ø¥Ø¹Ø¯Ø§Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ§ØªÙˆØ±Ø©
  const items = Object.values(cart).map(i=>({id:i.id,name:i.name,price:i.price,qty:i.qty}));
  const total = items.reduce((s,i)=>s + i.price*i.qty,0);
  const createdAt = new Date();
  const createdAtStr = createdAt.toLocaleString('ar-EG', { dateStyle: 'full', timeStyle: 'short' });

  // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø§ÙØ°Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø© (Ø³ØªØ­ÙˆÙŠ ØµÙˆØ±Ø© Ø§Ù„Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ù…Ø±ÙÙˆØ¹Ø© â€” DataURL)
  const invoiceWindow = window.open('', '_blank');
  const receiptDataURLforInvoice = currentReceiptDataUrl; // Data URL ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡ Ù…Ø³Ø¨Ù‚Ù‹Ø§
  const shopNumber = '249905309303';

  // Ù†Øµ ÙˆØ§ØªØ³Ø§Ø¨ Ù…Ø¨Ø¯Ø¦ÙŠ (Ø³ÙŠØ¸Ù‡Ø± Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± "Ø·Ø¨Ø§Ø¹Ø© Ø«Ù… ÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨")
  const whatsappMsg = encodeURIComponent(
    `ğŸ§¾ ÙØ§ØªÙˆØ±Ø© - Ù…Ø·Ø¹Ù… Ø§Ù„Ù…Ø°Ø§Ù‚ Ø§Ù„Ø³ÙˆØ¯Ø§Ù†ÙŠØ©\n\n` +
    `Ø§Ù„Ø§Ø³Ù…: ${name}\n` +
    `Ø§Ù„Ù‡Ø§ØªÙ: ${phone}\n` +
    `Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${address}\n` +
    `Ø§Ù„ÙˆÙ‚Øª: ${createdAtStr}\n\n` +
    `Ø§Ù„Ø£ØµÙ†Ø§Ù:\n` +
    items.map(i => `- ${i.name} Ã— ${i.qty} = ${i.price * i.qty} Ø¬.Ø³`).join('\n') +
    `\n\nØ§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${total} Ø¬.Ø³\n` +
    `Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹: ${paymentMethod}\n\n` +
    `Ø§Ù„Ù…Ø±Ø¬Ùˆ Ø¥Ø±Ø³Ø§Ù„ Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø¯ÙØ¹ (ØµÙˆØ±Ø©) ÙˆØ§Ù„ÙØ§ØªÙˆØ±Ø© ÙÙŠ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨. Ø´ÙƒØ±Ø§Ù‹ Ù„ÙƒÙ…!`
  );

  invoiceWindow.document.write(`
    <!doctype html>
    <html lang="ar" dir="rtl">
    <head>
      <meta charset="utf-8">
      <title>ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø·Ù„Ø¨ â€” Ù…Ø·Ø¹Ù… Ø§Ù„Ù…Ø°Ø§Ù‚ Ø§Ù„Ø³ÙˆØ¯Ø§Ù†ÙŠØ©</title>
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <style>
        body{font-family:"Noto Naskh Arabic",Tahoma,Arial;direction:rtl;padding:20px;color:#222;background:#fff}
        .wrap{max-width:720px;margin:0 auto;background:#fff;padding:18px;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,0.06)}
        h1{color:#c94a1f;margin:0 0 8px 0}
        p{margin:6px 0;color:#333}
        table{width:100%;border-collapse:collapse;margin-top:12px}
        th,td{border:1px solid #ddd;padding:8px;text-align:center}
        th{background:#f6f6f6}
        .total{font-weight:800;color:#c94a1f;margin-top:12px;text-align:left;font-size:18px}
        .meta{color:#666;font-size:14px;margin-top:6px}
        .actions{display:flex;gap:10px;margin-top:14px;flex-wrap:wrap}
        .btn{background:#c94a1f;color:#fff;padding:10px 14px;border-radius:8px;border:0;cursor:pointer;font-weight:700}
        .btn-print{background:#2b2b2b}
        img.receipt{max-width:280px;border-radius:8px;margin-top:10px;border:1px solid #ddd;display:block}
        @media print {
          .actions{display:none}
        }
      </style>
    </head>
    <body>
      <div class="wrap">
        <h1>ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø·Ù„Ø¨</h1>
        <p><strong>Ø§Ù„Ù…Ø·Ø¹Ù…:</strong> Ù…Ø·Ø¹Ù… Ø§Ù„Ù…Ø°Ø§Ù‚ Ø§Ù„Ø³ÙˆØ¯Ø§Ù†ÙŠØ©</p>
        <p><strong>Ø§Ù„Ø§Ø³Ù…:</strong> ${escapeHtml(name)}<br>
           <strong>Ø§Ù„Ù‡Ø§ØªÙ:</strong> ${escapeHtml(phone)}<br>
           <strong>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</strong> ${escapeHtml(address)}</p>
        <p class="meta"><strong>Ø§Ù„ÙˆÙ‚Øª:</strong> ${escapeHtml(createdAtStr)}<br>
           <strong>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹:</strong> ${escapeHtml(paymentMethod)}</p>

        <table>
          <thead>
            <tr><th>Ø§Ù„ØµÙ†Ù</th><th>Ø§Ù„ÙƒÙ…ÙŠØ©</th><th>Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø© (Ø¬.Ø³)</th><th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ (Ø¬.Ø³)</th></tr>
          </thead>
          <tbody>
            ${items.map(i=>`<tr>
              <td>${escapeHtml(i.name)}</td>
              <td>${i.qty}</td>
              <td>${i.price}</td>
              <td>${i.price * i.qty}</td>
            </tr>`).join('')}
          </tbody>
        </table>

        <div class="total">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒÙ„ÙŠ: ${total} Ø¬.Ø³</div>

        <h3 style="margin-top:12px">ğŸ“¸ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¯ÙØ¹ (Ø§Ù„Ù…Ø±ÙÙ‚)</h3>
        ${receiptDataURLforInvoice ? `<img class="receipt" src="${receiptDataURLforInvoice}" alt="Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¯ÙØ¹">` : '<div style="color:#c94a1f">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ø§ÙŠÙ†Ø© Ù„Ù„Ø¥ÙŠØµØ§Ù„</div>'}

        <div class="actions">
          <button class="btn btn-print" id="printBtn">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø«Ù… ÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨</button>
          <button class="btn" id="closeBtn">âœ• Ø¥ØºÙ„Ø§Ù‚</button>
        </div>

        <p style="color:#666;margin-top:10px">Ù…Ù„Ø§Ø­Ø¸Ø©: Ø¨Ø¹Ø¯ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©ØŒ Ø³ÙŠØªÙ… ÙØªØ­ Ù…Ø­Ø§Ø¯Ø«Ø© ÙˆØ§ØªØ³Ø§Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø±Ø³Ø§Ù„Ø© Ø¬Ø§Ù‡Ø²Ø© â€” Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø±ÙØ§Ù‚ ØµÙˆØ±Ø© Ø§Ù„Ø¥ÙŠØµØ§Ù„ ÙˆØ§Ù„ÙØ§ØªÙˆØ±Ø© Ø«Ù… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ ÙŠØ¯ÙˆÙŠØ§Ù‹ Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨.</p>
      </div>

      <script>
        (function(){
          const shopNumber = '${shopNumber}';
          const whatsappMsg = '${whatsappMsg}';

          function openWhatsApp(){
            const url = 'https://wa.me/' + shopNumber + '?text=' + whatsappMsg;
            window.open(url, '_blank');
          }

          document.getElementById('printBtn').addEventListener('click', function(){
            // Ø·Ø¨Ø§Ø¹Ø©ØŒ Ø«Ù… ÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨
            window.print();
            // ÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨ Ø¨Ø¹Ø¯ ØªØ£Ø®ÙŠØ± Ù‚ØµÙŠØ± Ù„ØªØ±Ùƒ Ù…ØªØ³Ø¹ Ù„Ø·Ø§Ø¨Ø¹Ø© Ø§Ù„Ù…ØªØµÙØ­
            setTimeout(openWhatsApp, 500);
          });

          document.getElementById('closeBtn').addEventListener('click', function(){
            window.close();
          });

          // Ø¥Ù† Ø£Ø±Ø¯ØªØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø£ÙŠØ¶Ø§Ù‹ ÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„Ù†Ø§ÙØ°Ø© (ØºÙŠØ± Ù…ÙØ¹Ù‘Ù„)
        })();
      <\/script>
    </body>
    </html>
  `);
  invoiceWindow.document.close();

  // Ø¥Ø¹Ù„Ø§Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  alert('âœ… ØªÙ… ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø© â€” Ø¨Ø¹Ø¯ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© ÙŠØ±Ø¬Ù‰ Ø¥Ø±Ø³Ø§Ù„ ØµÙˆØ±Ø© Ø§Ù„Ø¥ÙŠØµØ§Ù„ ÙˆØ§Ù„ÙØ§ØªÙˆØ±Ø© Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨.');

  // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø³Ù„Ø© ÙˆØ§Ù„Ø­Ù‚ÙˆÙ„ Ù…Ø­Ù„ÙŠØ§Ù‹ (Ø¨Ø¹Ø¯ ÙØªØ±Ø© Ù‚ØµÙŠØ±Ø© Ø¥ØªØ§Ø­Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…)
  // Ù„Ø§Ø­Ø¸: Ø¥Ù† Ø£Ø±Ø¯Øª Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø³Ø¬Ù„ Ù…Ø­Ù„ÙŠ Ù„Ù„ÙÙˆØ§ØªÙŠØ± ÙŠÙ…ÙƒÙ† Ø­ÙØ¸Ù‡ ÙÙŠ localStorage Ù‡Ù†Ø§.
  setTimeout(()=>{ cart = {}; updateCartUI(); overlay.classList.remove('open'); }, 500);
});

/* ===== init ===== */
updateCartUI();

</script>

</body>
</html>
